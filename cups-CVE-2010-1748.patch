diff -up cups-1.4.2/cgi-bin/var.c.CVE-2010-1748 cups-1.4.2/cgi-bin/var.c
--- cups-1.4.2/cgi-bin/var.c.CVE-2010-1748	2010-06-16 15:12:00.909056114 +0100
+++ cups-1.4.2/cgi-bin/var.c	2010-06-16 15:12:15.129181400 +0100
@@ -1112,6 +1112,9 @@ cgi_initialize_string(const char *data)	
 	    * Read the hex code...
 	    */
 
+            if (!isxdigit(data[1] & 255) || !isxdigit(data[2] & 255))
+	      return (0);
+
             if (s < (value + sizeof(value) - 1))
 	    {
               data ++;
